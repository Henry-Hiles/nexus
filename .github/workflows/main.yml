name: "Build Windows EXE"

on:
  workflow_dispatch:

jobs:
  build-windows:
    runs-on: "windows-latest"

    steps:
      - name: "Checkout repository"
        uses: "actions/checkout@v4"

      - name: "Set up Flutter"
        uses: "subosito/flutter-action@v2"

      - name: "Set up Rust"
        uses: "dtolnay/rust-toolchain@stable"
        with:
          targets: "x86_64-pc-windows-msvc"

      - name: "Install Flutter dependencies"
        run: "flutter pub get"

      - name: "Build Windows EXE"
        run: |
          flutter pub run build_runner build --delete-conflicting-outputs
          flutter build windows --release

      - name: "Upload Windows build"
        uses: "actions/upload-artifact@v4"
        with:
          name: "windows-exe"
          path: "build/windows/x64/runner/Release/nexus.exe"